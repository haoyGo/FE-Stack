## Prometheus
开源的监控告警框架。收集 `Metrics`，通过 `TSDB(Time Series Database)` 存储，key-value 格式数据。

### 架构图
![architecture](/assets/architecture.png)

#### 主要模块
* `Server`：负责拉取和储存时序数据，拉取通过 HTTP pull。
* `Exporters`：`Metrics` 提供者，需要监控的系统。
* `PromQL`：Prometheus 提供的函数式查询语言。
* `PushGateway`：支持短期任务。
* `AlertManager`：告警。
* `UI Lib`：可视化展示。

#### Data Model
* Metric
  数据收集的纬度是以 `Metric` 独立开的。格式必须符合正则：`[a-zA-Z_:][a-zA-Z0-9_:]*`
* Label
  数据存储的格式是 key-value，`Label` 可作为搜索项。格式必须符合正则：` [a-zA-Z_][a-zA-Z0-9_]*`
* Sample
  通过查询返回的数据样本，结构为
  ``` JavaScript
  sample: {
      metric: {
          key: value
          ...
      },
      values: [timestamp, value][]
  }
  ```
* Notation
  格式：`<metric name>{<label name>=<label value>, ...}`

#### Metric Types
* Counter
  计数，累计指标，不做减法。
* Gauge
  与 Counter 区别是，可用于减法。
* Histogram
  直方图。
* Summary
  总合。

#### Jobs And Instances
一个供拉取指标的节点为一个 `Instance`，多个共同目的的 `Instance` 组成 `Jobs`。

   